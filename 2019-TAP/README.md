<center>**Abstract**</center>

With the widespread usage of Web applications, the security issues of source code are
increasing. The exposed vulnerabilities seriously endanger the interests of service providers
and customers. There are some models for solving this problem. However, most of them
rely on complex graphs generated from source code or regex patterns based on expert
experience. In this paper, TAP, which is based on token mechanism and deep learning tech-
nology, was proposed as an analysis model to discover the vulnerabilities of PHP: Hypertext
Preprocessor (PHP) Web programs conveniently and easily. Based on the token mecha-
nism of PHP language, a custom tokenizer was designed, and it unifies tokens, supports
some features of PHP and optimizes the parsing. Besides, the tokenizer also implements
parameter iteration to achieve data flow analysis. On the Software Assurance Reference
Dataset(SARD) and SQLI-LABS dataset, we trained the deep learning model of TAP by
combining the word2vec model with Long Short-Term Memory (LSTM) network algorithm.
According to the experiment on the dataset of CWE-89, TAP not only achieves the 0.9941
Area Under the Curve(AUC), which is better than other models, but also achieves the high-
est accuracy: 0.9787. Further, compared with RIPS, TAP shows much better in multiclass
classification with 0.8319 Kappa and 0.0840 hamming distance.
